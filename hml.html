<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DATA NEXUS | The World's Analytics Engine</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/framer-motion@10.12.16/dist/framer-motion.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://unpkg.com/recharts/umd/Recharts.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        nexus: {
                            900: '#0a0a0f',
                            800: '#13131f',
                            accent: '#00f0ff',
                            glass: 'rgba(20, 20, 30, 0.6)',
                            border: 'rgba(255, 255, 255, 0.1)'
                        }
                    },
                    fontFamily: {
                        mono: ['"Fira Code"', 'monospace'],
                        sans: ['"Inter"', 'sans-serif']
                    },
                    animation: {
                        'spin-slow': 'spin 8s linear infinite',
                        'pulse-fast': 'pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                    }
                }
            }
        }
    </script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Fira+Code:wght@400;600&display=swap');

        body {
            background-color: #050505;
            color: white;
            overflow: hidden;
            /* Prevent scroll, it's an OS */
            user-select: none;
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        ::-webkit-scrollbar-thumb {
            background: rgba(0, 240, 255, 0.3);
            border-radius: 10px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 240, 255, 0.6);
        }

        .glass-panel {
            background: rgba(15, 20, 35, 0.75);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.08);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .crt-overlay {
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            background-size: 100% 2px, 3px 100%;
            pointer-events: none;
        }
    </style>
</head>

<body>

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useMemo } = React;
        const { motion, AnimatePresence } = window.Motion;
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer, AreaChart, Area } = window.Recharts;

        // --- DATA SIMULATION (BAU & SERVICES) ---

        const BAU_DEPTS = [
            { id: 'ag-econ', name: 'Agricultural Economics', projects: 142, status: 'Active' },
            { id: 'agronomy', name: 'Agronomy', projects: 89, status: 'Processing' },
            { id: 'fpm', name: 'Farm Power & Machinery', projects: 56, status: 'Active' },
            { id: 'biotech', name: 'Biotechnology', projects: 112, status: 'Analyzing' },
            { id: 'rural-soc', name: 'Rural Sociology', projects: 78, status: 'Active' },
            { id: 'animal-sci', name: 'Animal Science', projects: 203, status: 'Complete' },
        ];

        const SERVICES = [
            { id: 1, title: "Thesis Statistical Analysis", price: "৳5,000", desc: "SPSS/Stata processing for academic papers." },
            { id: 2, title: "Predictive Crop Modeling", price: "৳50,000", desc: "AI-driven yield prediction for large farms." },
            { id: 3, title: "Supply Chain Optimization", price: "৳25,000", desc: "Logistics algorithms for agribusiness." },
            { id: 4, title: "Genomic Data Sequencing", price: "৳12,000", desc: "Bioinformatics pipeline for DNA data." },
        ];

        const MOCK_CHAT_RESPONSES = {
            default: "I am Cortex, the AI Core of this facility. I can analyze data, quote prices, or navigate the BAU archives.",
            price: "Based on your requirements, here is a tailored service package:",
            research: "Accessing BAU Central Database... Retrieved 452 active research papers.",
            hello: "Greetings, Administrator. Systems are operating at 99.9% efficiency.",
        };

        // --- ICONS COMPONENT WRAPPER ---
        const Icon = ({ name, size = 20, color = "currentColor", className = "" }) => {
            // Lucide icons are injected as SVGs
            useEffect(() => {
                lucide.createIcons();
            }, [name]);
            return <i data-lucide={name} className={className} style={{ width: size, height: size, color: color }}></i>;
        };

        // --- 1. BOOT SEQUENCE COMPONENT ---
        const BootSequence = ({ onComplete }) => {
            const [logs, setLogs] = useState([]);

            useEffect(() => {
                const sequence = [
                    "Initializing Kernel...", "Loading Memory Modules...",
                    "Mounting Virtual File System...", "Connecting to Global Satellite Network...",
                    "Authenticating User...", "Access Granted: LEVEL 5 CLEARANCE"
                ];
                let delay = 0;
                sequence.forEach((log, i) => {
                    delay += Math.random() * 800;
                    setTimeout(() => {
                        setLogs(prev => [...prev, `> ${log}`]);
                        if (i === sequence.length - 1) setTimeout(onComplete, 1000);
                    }, delay);
                });
            }, []);

            return (
                <div className="fixed inset-0 bg-black z-50 flex flex-col items-center justify-center font-mono text-green-500">
                    <div className="w-96 h-64 p-4 border border-green-900 bg-black/90 rounded shadow-[0_0_50px_rgba(0,255,0,0.1)]">
                        <div className="mb-4 flex justify-between border-b border-green-900 pb-2">
                            <span>NEXUS_BOOT_LOADER_V1.0</span>
                            <span className="animate-pulse">●</span>
                        </div>
                        <div className="flex flex-col space-y-1 text-sm">
                            {logs.map((log, i) => (
                                <span key={i} className="opacity-80">{log}</span>
                            ))}
                        </div>
                    </div>
                    <h1 className="mt-8 text-4xl font-bold tracking-[10px] text-white animate-pulse">NEXUS OS</h1>
                </div>
            );
        };

        // --- 2. WINDOW COMPONENT (DRAGGABLE) ---
        const WindowFrame = ({ app, onClose, isActive, onFocus }) => {
            return (
                <motion.div
                    drag
                    dragMomentum={false}
                    initial={{ scale: 0.8, opacity: 0, y: 20 }}
                    animate={{ scale: 1, opacity: 1, y: 0 }}
                    exit={{ scale: 0.8, opacity: 0 }}
                    onMouseDown={onFocus}
                    className={`absolute top-10 left-10 w-[800px] h-[500px] glass-panel rounded-lg overflow-hidden flex flex-col ${isActive ? 'z-40 ring-1 ring-nexus-accent' : 'z-10 opacity-90'}`}
                    style={{
                        top: app.y || 100,
                        left: app.x || 100,
                        width: app.width || 800,
                        height: app.height || 500
                    }}
                >
                    {/* Window Header */}
                    <div className="h-10 bg-nexus-800/50 border-b border-nexus-border flex items-center justify-between px-4 cursor-grab active:cursor-grabbing">
                        <div className="flex items-center gap-2 text-nexus-accent text-sm font-mono">
                            <Icon name={app.icon} size={14} />
                            <span className="uppercase tracking-widest">{app.title}</span>
                        </div>
                        <div className="flex gap-2">
                            <button onClick={onClose} className="w-3 h-3 rounded-full bg-red-500 hover:bg-red-400 transition-colors"></button>
                            <button className="w-3 h-3 rounded-full bg-yellow-500"></button>
                            <button className="w-3 h-3 rounded-full bg-green-500"></button>
                        </div>
                    </div>

                    {/* Window Content */}
                    <div className="flex-1 overflow-auto p-4 bg-nexus-900/40 relative">
                        {app.component}
                    </div>
                </motion.div>
            );
        };

        // --- 3. APPS (The Content) ---

        // APP: CORTEX AI
        const CortexAI = () => {
            const [messages, setMessages] = useState([
                { sender: 'ai', text: MOCK_CHAT_RESPONSES.default }
            ]);
            const [input, setInput] = useState('');
            const endRef = useRef(null);

            const handleSend = (e) => {
                e.preventDefault();
                if (!input.trim()) return;

                const userMsg = { sender: 'user', text: input };
                setMessages(prev => [...prev, userMsg]);

                // Simple Logic Engine
                let aiText = MOCK_CHAT_RESPONSES.default;
                let specialData = null;

                const lower = input.toLowerCase();
                if (lower.includes('price') || lower.includes('cost') || lower.includes('offer')) {
                    aiText = MOCK_CHAT_RESPONSES.price;
                    specialData = 'pricing_card';
                } else if (lower.includes('bau') || lower.includes('research')) {
                    aiText = MOCK_CHAT_RESPONSES.research;
                } else if (lower.includes('hello') || lower.includes('hi')) {
                    aiText = MOCK_CHAT_RESPONSES.hello;
                }

                setTimeout(() => {
                    setMessages(prev => [...prev, { sender: 'ai', text: aiText, special: specialData }]);
                }, 800);

                setInput('');
            };

            useEffect(() => { endRef.current?.scrollIntoView({ behavior: "smooth" }) }, [messages]);

            return (
                <div className="flex flex-col h-full">
                    <div className="flex-1 space-y-4 mb-4 pr-2">
                        {messages.map((m, i) => (
                            <motion.div
                                initial={{ opacity: 0, x: m.sender === 'ai' ? -20 : 20 }}
                                animate={{ opacity: 1, x: 0 }}
                                key={i}
                                className={`flex ${m.sender === 'user' ? 'justify-end' : 'justify-start'}`}
                            >
                                <div className={`max-w-[80%] p-3 rounded-lg text-sm ${m.sender === 'user' ? 'bg-nexus-accent text-black font-bold' : 'bg-nexus-800 border border-nexus-border text-nexus-accent font-mono'}`}>
                                    <p>{m.text}</p>

                                    {/* Special AI Response Widgets */}
                                    {m.special === 'pricing_card' && (
                                        <div className="mt-3 p-2 bg-black/50 rounded border border-white/10">
                                            <div className="text-xs text-gray-400 mb-1">RECOMMENDED SERVICE</div>
                                            <div className="font-bold text-white">Advanced Thesis Analysis</div>
                                            <div className="text-green-400 text-lg">৳5,000</div>
                                            <button className="mt-2 w-full py-1 bg-nexus-accent text-black text-xs font-bold hover:bg-white transition">GENERATE INVOICE</button>
                                        </div>
                                    )}
                                </div>
                            </motion.div>
                        ))}
                        <div ref={endRef}></div>
                    </div>
                    <form onSubmit={handleSend} className="flex gap-2">
                        <input
                            type="text"
                            value={input}
                            onChange={(e) => setInput(e.target.value)}
                            placeholder="Ask Cortex about analysis..."
                            className="flex-1 bg-nexus-800 border border-nexus-border rounded px-4 py-2 text-white focus:outline-none focus:border-nexus-accent font-mono"
                        />
                        <button type="submit" className="bg-nexus-accent text-black p-2 rounded hover:bg-white transition">
                            <Icon name="send" size={20} />
                        </button>
                    </form>
                </div>
            );
        };

        // APP: BAU RESEARCH HUB
        const ResearchHub = () => {
            return (
                <div className="grid grid-cols-3 gap-4">
                    {BAU_DEPTS.map((dept, i) => (
                        <motion.div
                            whileHover={{ scale: 1.05 }}
                            key={i}
                            className="bg-nexus-800/50 border border-nexus-border p-4 rounded cursor-pointer hover:border-nexus-accent group"
                        >
                            <div className="flex justify-between items-start mb-2">
                                <div className="p-2 bg-blue-500/20 rounded text-blue-400 group-hover:text-nexus-accent group-hover:bg-nexus-accent/20 transition-colors">
                                    <Icon name="folder" size={24} />
                                </div>
                                <span className="text-[10px] bg-white/10 px-2 py-0.5 rounded text-gray-300">{dept.status}</span>
                            </div>
                            <h3 className="font-bold text-sm text-gray-200">{dept.name}</h3>
                            <p className="text-xs text-gray-500 mt-1">{dept.projects} Data Sets</p>
                        </motion.div>
                    ))}
                </div>
            );
        };

        // APP: ANALYTICS DASHBOARD
        const Analytics = () => {
            const data = [
                { name: 'Jan', uv: 4000, pv: 2400, amt: 2400 },
                { name: 'Feb', uv: 3000, pv: 1398, amt: 2210 },
                { name: 'Mar', uv: 2000, pv: 9800, amt: 2290 },
                { name: 'Apr', uv: 2780, pv: 3908, amt: 2000 },
                { name: 'May', uv: 1890, pv: 4800, amt: 2181 },
            ];

            return (
                <div className="h-full flex flex-col gap-4">
                    <div className="flex gap-4 mb-2">
                        <div className="flex-1 bg-nexus-800 border border-nexus-border p-3 rounded">
                            <div className="text-xs text-gray-400">TOTAL PROCESSING POWER</div>
                            <div className="text-2xl font-mono text-nexus-accent">45.2 TB/s</div>
                        </div>
                        <div className="flex-1 bg-nexus-800 border border-nexus-border p-3 rounded">
                            <div className="text-xs text-gray-400">ACTIVE CLIENTS</div>
                            <div className="text-2xl font-mono text-green-400">1,204</div>
                        </div>
                    </div>
                    <div className="flex-1 bg-nexus-800/30 border border-nexus-border rounded p-2">
                        <ResponsiveContainer width="100%" height="100%">
                            <AreaChart data={data}>
                                <defs>
                                    <linearGradient id="colorPv" x1="0" y1="0" x2="0" y2="1">
                                        <stop offset="5%" stopColor="#00f0ff" stopOpacity={0.8} />
                                        <stop offset="95%" stopColor="#00f0ff" stopOpacity={0} />
                                    </linearGradient>
                                </defs>
                                <CartesianGrid strokeDasharray="3 3" stroke="#333" />
                                <XAxis dataKey="name" stroke="#666" />
                                <YAxis stroke="#666" />
                                <Tooltip contentStyle={{ backgroundColor: '#000', borderColor: '#333' }} />
                                <Area type="monotone" dataKey="pv" stroke="#00f0ff" fillOpacity={1} fill="url(#colorPv)" />
                            </AreaChart>
                        </ResponsiveContainer>
                    </div>
                </div>
            );
        };

        // APP: SERVICES
        const ServiceStore = () => {
            return (
                <div className="space-y-3">
                    <div className="p-4 bg-nexus-accent/10 border border-nexus-accent rounded mb-6 text-center">
                        <h2 className="text-xl font-bold text-nexus-accent">PRECISE SERVICE OFFERS</h2>
                        <p className="text-sm text-gray-300">Select a package to initiate protocol.</p>
                    </div>
                    {SERVICES.map(s => (
                        <div key={s.id} className="flex items-center justify-between p-4 bg-nexus-800 hover:bg-nexus-700 border border-nexus-border hover:border-nexus-accent transition-all rounded group">
                            <div>
                                <h3 className="font-bold text-white group-hover:text-nexus-accent">{s.title}</h3>
                                <p className="text-xs text-gray-400">{s.desc}</p>
                            </div>
                            <div className="text-right">
                                <div className="font-mono text-lg text-green-400">{s.price}</div>
                                <button className="text-[10px] uppercase tracking-widest border border-gray-600 px-2 py-1 mt-1 rounded hover:bg-white hover:text-black transition">Purchase</button>
                            </div>
                        </div>
                    ))}
                </div>
            );
        }

        // --- 4. MAIN OS LAYOUT ---
        const NexusOS = () => {
            const [booted, setBooted] = useState(false);
            const [windows, setWindows] = useState([]); // { id, app, zIndex }
            const [activeId, setActiveId] = useState(null);
            const [time, setTime] = useState(new Date());

            // Clock
            useEffect(() => {
                const timer = setInterval(() => setTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);

            const openApp = (appId) => {
                if (windows.find(w => w.id === appId)) {
                    setActiveId(appId);
                    return;
                }
                const appConfig = APPS.find(a => a.id === appId);
                setWindows([...windows, { ...appConfig, z: windows.length + 1 }]);
                setActiveId(appId);
            };

            const closeWindow = (id) => {
                setWindows(windows.filter(w => w.id !== id));
            };

            const focusWindow = (id) => {
                setActiveId(id);
            };

            const APPS = [
                { id: 'cortex', title: 'Cortex AI', icon: 'bot', component: <CortexAI />, color: 'text-purple-400' },
                { id: 'bau_hub', title: 'BAU Research', icon: 'database', component: <ResearchHub />, color: 'text-blue-400' },
                { id: 'analytics', title: 'Global Analytics', icon: 'bar-chart-2', component: <Analytics />, color: 'text-green-400' },
                { id: 'store', title: 'Service Store', icon: 'shopping-bag', component: <ServiceStore />, color: 'text-yellow-400' },
            ];

            if (!booted) return <BootSequence onComplete={() => setBooted(true)} />;

            return (
                <div className="relative w-screen h-screen overflow-hidden crt-overlay">

                    {/* Animated Background */}
                    <div className="absolute inset-0 z-0">
                        <div className="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[800px] h-[800px] bg-nexus-accent/5 rounded-full blur-[120px] animate-pulse-fast"></div>
                        <div className="absolute top-0 left-0 w-full h-full bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"></div>

                        {/* Grid Lines */}
                        <div className="absolute inset-0"
                            style={{ backgroundImage: 'linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px)', backgroundSize: '50px 50px' }}>
                        </div>
                    </div>

                    {/* Desktop Area */}
                    <div className="relative z-10 w-full h-full p-8 flex flex-col items-start gap-6">
                        {APPS.map((app) => (
                            <motion.button
                                key={app.id}
                                whileHover={{ scale: 1.1, backgroundColor: 'rgba(255,255,255,0.05)' }}
                                whileTap={{ scale: 0.9 }}
                                onClick={() => openApp(app.id)}
                                className="flex flex-col items-center gap-2 group p-4 rounded-lg transition-colors"
                            >
                                <div className={`p-4 rounded-2xl bg-nexus-800/80 border border-nexus-border shadow-lg group-hover:border-nexus-accent group-hover:shadow-[0_0_15px_rgba(0,240,255,0.3)] transition-all duration-300 ${app.color}`}>
                                    <Icon name={app.icon} size={32} />
                                </div>
                                <span className="text-xs font-medium text-gray-300 group-hover:text-white tracking-wide bg-black/50 px-2 py-1 rounded backdrop-blur-sm">{app.title}</span>
                            </motion.button>
                        ))}
                    </div>

                    {/* Active Windows */}
                    <AnimatePresence>
                        {windows.map((win) => (
                            <WindowFrame
                                key={win.id}
                                app={win}
                                isActive={activeId === win.id}
                                onClose={() => closeWindow(win.id)}
                                onFocus={() => focusWindow(win.id)}
                            />
                        ))}
                    </AnimatePresence>

                    {/* Status Bar / Taskbar */}
                    <div className="absolute bottom-0 w-full h-12 glass-panel border-t border-nexus-border z-50 flex items-center justify-between px-6">
                        <div className="flex items-center gap-4">
                            <div className="w-8 h-8 bg-nexus-accent rounded flex items-center justify-center text-black font-bold">N</div>
                            <span className="text-xs font-mono text-gray-400 hidden sm:block">SYSTEM STATUS: ONLINE</span>
                        </div>

                        {/* Dock Apps */}
                        <div className="flex items-center gap-2">
                            {windows.map(w => (
                                <div key={w.id} onClick={() => focusWindow(w.id)} className={`h-1 w-8 rounded-full transition-all ${activeId === w.id ? 'bg-nexus-accent w-12' : 'bg-gray-600'}`}></div>
                            ))}
                        </div>

                        <div className="flex items-center gap-4 text-xs font-mono text-nexus-accent">
                            <div className="flex items-center gap-2">
                                <Icon name="wifi" size={14} />
                                <span>5G-BAU-NET</span>
                            </div>
                            <div className="flex items-center gap-2">
                                <Icon name="battery-charging" size={14} />
                                <span>100%</span>
                            </div>
                            <div className="px-3 py-1 bg-nexus-800 rounded border border-nexus-border">
                                {time.toLocaleTimeString()}
                            </div>
                        </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<NexusOS />);
    </script>
</body>

</html>